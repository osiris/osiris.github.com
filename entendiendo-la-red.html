<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es">
<head>
<title>entendiendo la red</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="entendiendo la red"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2013-04-04"/>
<meta name="author" content="Osiris Alejandro Gómez"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<link rel="stylesheet" href="osiux.css" type="text/css" />


</head>
<body>
<div id="org-div-home-and-up" style="text-align:right;font-size:70%;white-space:nowrap;">
 <a accesskey="h" href="index.html"> UP </a>
 |
 <a accesskey="H" href="index.html"> HOME </a>
</div>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">entendiendo la red</h1>


<div id="outline-container-1" class="outline-3">
<h3 id="sec-1">Topología, redes y Subredes</h3>
<div class="outline-text-3" id="text-1">


<ul>
<li>centralizada

<p>
     <img src="redes-centralizadas.png"  alt="redes-centralizadas.png" />
</p>
</li>
<li>descentralizada

<p>
     <img src="redes-descentralizadas.png"  alt="redes-descentralizadas.png" />
</p>
</li>
<li>en malla o <i>mesh</i>

<p>
     <img src="redes-mesh.png"  alt="redes-mesh.png" />
</p></li>
</ul>


</div>

</div>

<div id="outline-container-2" class="outline-3">
<h3 id="sec-2">Protocolos ARP/IP/ICMP/UDP/TCP/IP</h3>
<div class="outline-text-3" id="text-2">

</div>

</div>

<div id="outline-container-3" class="outline-3">
<h3 id="sec-3">Ruteo</h3>
<div class="outline-text-3" id="text-3">


<ul>
<li>estático
</li>
<li>dinámico
</li>
</ul>


</div>

</div>

<div id="outline-container-4" class="outline-3">
<h3 id="sec-4">Asignación de IPs por medio de DHCP</h3>
<div class="outline-text-3" id="text-4">


<ul>
<li>DHCP server
</li>
<li>DHCP client
</li>
</ul>



</div>

<div id="outline-container-4-1" class="outline-4">
<h4 id="sec-4-1">Red de 4 equipos</h4>
<div class="outline-text-4" id="text-4-1">


<p>
    <img src="redes-lan.png"  alt="redes-lan.png" />
</p>
</div>

</div>

<div id="outline-container-4-2" class="outline-4">
<h4 id="sec-4-2"><code>B</code> dice, <b>necesito una IP!</b></h4>
<div class="outline-text-4" id="text-4-2">


<ul>
<li>mensaje: <code>DHCPDISCOVER</code>
</li>
<li>protocolo: UDP
</li>
<li>puerto destino: 67
</li>
<li>dirección física: 01:12:23:34:45:bb
</li>
</ul>


<p>
    <img src="redes-dhcp-discover.png"  alt="redes-dhcp-discover.png" />
</p>
</div>

</div>

<div id="outline-container-4-3" class="outline-4">
<h4 id="sec-4-3"><code>D</code> dice, <b>yo te puedo dar IP!</b></h4>
<div class="outline-text-4" id="text-4-3">


<ul>
<li>mensaje: <code>DHCPOFFER</code>
</li>
<li>dirección física: 01:12:23:34:45:dd
</li>
<li>dirección IP: 192.168.10.102
</li>
<li>gateway: 192.168.10.1
</li>
<li>dns primario: 8.8.8.8
</li>
<li>dns secundario: 8.8.4.4
</li>
</ul>





<pre class="src src-ditaa">-----+---------+&lt;--------+---------+-----
     |         |         |         ^
     |         v         |         |
   +-+-+     +-+-+     +-+-+     +-+-+
   | A |     | B |     | C |     | D |
   +---+     +---+     +---+     +---+
</pre>


<p>
    <img src="redes-dhcp-offer.png"  alt="redes-dhcp-offer.png" />
</p>
</div>

</div>

<div id="outline-container-4-4" class="outline-4">
<h4 id="sec-4-4"><code>B</code> dice, confirmo recepción!</h4>
<div class="outline-text-4" id="text-4-4">


<ul>
<li>mensaje: <code>DHCPREQUEST</code>
</li>
</ul>





<pre class="src src-ditaa">-----+---------+--------&gt;+--------&gt;+-----
     |         ^         |         |
     |         |         |         v
   +-+-+     +-+-+     +-+-+     +-+-+
   | A |     | B |     | C |     | D |
   +---+     +---+     +---+     +---+
</pre>


<p>
    <img src="redes-dhcp-request.png"  alt="redes-dhcp-request.png" />
</p>
</div>

</div>

<div id="outline-container-4-5" class="outline-4">
<h4 id="sec-4-5"><code>D</code> dice, confirmo confirmación!</h4>
<div class="outline-text-4" id="text-4-5">


<ul>
<li>mensaje: <code>DHCPACK</code>
</li>
</ul>





<pre class="src src-ditaa">-----+---------+&lt;--------+&lt;--------+-----
     |         |         |         ^
     |         v         |         |
   +-+-+     +-+-+     +-+-+     +-+-+
   | A |     | B |     | C |     | D |
   +---+     +---+     +---+     +---+
</pre>


<p>
    <img src="redes-dhcp-ack.png"  alt="redes-dhcp-ack.png" />
</p>
</div>
</div>

</div>

<div id="outline-container-5" class="outline-3">
<h3 id="sec-5">Resolución de nombres de dominios DNS</h3>
<div class="outline-text-3" id="text-5">





<pre class="src src-sh">host localhost
</pre>


<pre class="example">
localhost.gcoop.com.ar has address 127.0.0.1
</pre>





<pre class="src src-sh">dig osiux.com
</pre>



<pre class="example">
; &lt;&lt;&gt;&gt; DiG 9.8.4-P1 &lt;&lt;&gt;&gt; osiux.com
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 41959
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0

;; QUESTION SECTION:
;osiux.com.                  IN      A

;; ANSWER SECTION:
osiux.com.           300     IN      A       96.8.118.129

;; Query time: 221 msec
;; SERVER: 192.168.10.3#53(192.168.10.3)
;; WHEN: Tue Apr  9 23:41:15 2013
;; MSG SIZE  rcvd: 43

</pre>



</div>

<div id="outline-container-5-1" class="outline-4">
<h4 id="sec-5-1">viendo un paquete de query dns</h4>
<div class="outline-text-4" id="text-5-1">





<pre class="src src-sh">tcpdump -r dns-query.pcap -nvX
</pre>


<pre class="example">
02:14:20.301428 IP (tos 0x0, ttl 64, id 27874, offset 0, flags [none], proto UDP (17), length 55)
    127.0.0.1.57039 &gt; 127.0.0.1.53: 39172+ A? osiux.com. (27)
	0x0000:  4500 0037 6ce2 0000 4011 0fd2 7f00 0001  E..7l...@.......
	0x0010:  7f00 0001 decf 0035 0023 fe36 9904 0100  .......5.#.6....
	0x0020:  0001 0000 0000 0000 056f 7369 7578 0363  .........osiux.c
	0x0030:  6f6d 0000 0100 01                        om.....
</pre>


</div>

</div>

<div id="outline-container-5-2" class="outline-4">
<h4 id="sec-5-2">analizando un paquete de query dns</h4>
<div class="outline-text-4" id="text-5-2">





<pre class="src src-sh">tshark -r dns-query.pcap -VO dns
</pre>



<pre class="example">Frame 1: 71 bytes on wire (568 bits), 71 bytes captured (568 bits)
Linux cooked capture
Internet Protocol Version 4, Src: 127.0.0.1 (127.0.0.1), Dst: 127.0.0.1 (127.0.0.1)
User Datagram Protocol, Src Port: 57039 (57039), Dst Port: domain (53)
Domain Name System (query)
    Transaction ID: 0x9904
    Flags: 0x0100 Standard query
        0... .... .... .... = Response: Message is a query
        .000 0... .... .... = Opcode: Standard query (0)
        .... ..0. .... .... = Truncated: Message is not truncated
        .... ...1 .... .... = Recursion desired: Do query recursively
        .... .... .0.. .... = Z: reserved (0)
        .... .... ...0 .... = Non-authenticated data: Unacceptable
    Questions: 1
    Answer RRs: 0
    Authority RRs: 0
    Additional RRs: 0
    Queries
        osiux.com: type A, class IN
            Name: osiux.com
            Type: A (Host address)
            Class: IN (0x0001)

</pre>


</div>

</div>

<div id="outline-container-5-3" class="outline-4">
<h4 id="sec-5-3">capturar consultas al dns</h4>
<div class="outline-text-4" id="text-5-3">





<pre class="example">ssh root@linksys '/usr/sbin/tcpdump -i br0 -s 0 -w - dst port 53' &gt;linksys.pcap 
</pre>


</div>

</div>

<div id="outline-container-5-4" class="outline-4">
<h4 id="sec-5-4">ranking de dns</h4>
<div class="outline-text-4" id="text-5-4">





<pre class="example">tcpdump -r linksys.pcap -c 2000 -nnnA dst port 53 | \
egrep -o "A+\? .*\." | sed s/".$"//g | awk '{print $2}' | \
egrep -v "(osiux|fbcdn|akamai)" | sort | uniq -c | sort -nr | head
</pre>


<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup><col class="right" /><col class="left" />
</colgroup>
<tbody>
<tr><td class="right">47</td><td class="left">www.facebook.com</td></tr>
<tr><td class="right">42</td><td class="left">dns.msftncsi.com</td></tr>
<tr><td class="right">41</td><td class="left">su.ff.avast.com</td></tr>
<tr><td class="right">37</td><td class="left">ssl.google-analytics.com</td></tr>
<tr><td class="right">37</td><td class="left">ipv6.msftncsi.com</td></tr>
<tr><td class="right">32</td><td class="left">www.habbo.es</td></tr>
<tr><td class="right">26</td><td class="left">imap.googlemail.com</td></tr>
<tr><td class="right">21</td><td class="left">dynamic.zoneedit.com</td></tr>
<tr><td class="right">19</td><td class="left">www.msftncsi.com</td></tr>
<tr><td class="right">18</td><td class="left">kiwwwi.com.ar</td></tr>
</tbody>
</table>





<pre class="src src-gnuplot">reset 

<span class="org-constant">set</span> xdata time
<span class="org-constant">set</span> timefmt "%Y-%m-%d"
<span class="org-constant">set</span> format x "%d"

<span class="org-constant">set</span> <span class="org-type">title</span> "<span class="org-keyword">Plot</span>"
<span class="org-constant">set</span> xlabel "dominios"
<span class="org-constant">set</span> ylabel "cantidad"
<span class="org-constant">set</span> xtics nomirror
<span class="org-constant">set</span> ytics nomirror

<span class="org-keyword">plot</span> <span class="org-variable-name">data</span> <span class="org-type">using</span> 2:1 <span class="org-type">with</span> <span class="org-function-name">lines</span> <span class="org-type">lw</span> 2 <span class="org-type">lt</span> 3 <span class="org-type">title</span> <span class="org-string">'data'</span>
</pre>


<p>
    <img src="ranking-dns.png"  alt="ranking-dns.png" />
</p>
</div>
</div>

</div>

<div id="outline-container-6" class="outline-3">
<h3 id="sec-6">Redes Wireless</h3>
<div class="outline-text-3" id="text-6">


<ul>
<li>Emulan a las redes cableadeas
</li>
<li>infraestructura
</li>
<li>ad-hoc
</li>
</ul>


</div>

</div>

<div id="outline-container-7" class="outline-3">
<h3 id="sec-7">Sniffers nmap, dsniff</h3>
<div class="outline-text-3" id="text-7">

</div>

</div>

<div id="outline-container-8" class="outline-3">
<h3 id="sec-8">Análisis de tráfico mediante tcpdump</h3>
<div class="outline-text-3" id="text-8">

</div>

</div>

<div id="outline-container-9" class="outline-3">
<h3 id="sec-9">Firewall, Port Forwarding, NAT</h3>
<div class="outline-text-3" id="text-9">


</div>

<div id="outline-container-9-1" class="outline-4">
<h4 id="sec-9-1">iptables</h4>
<div class="outline-text-4" id="text-9-1">

</div>
</div>

</div>

<div id="outline-container-10" class="outline-3">
<h3 id="sec-10">Túneles y Redes Privadas Virtuales VPN</h3>
<div class="outline-text-3" id="text-10">


</div>

<div id="outline-container-10-1" class="outline-4">
<h4 id="sec-10-1">Redireccionar puertos con <code>ssh</code></h4>
<div class="outline-text-4" id="text-10-1">





<pre class="example">ssh -L 2525:localhost:25 osiux.com    
</pre>


</div>

</div>

<div id="outline-container-10-2" class="outline-4">
<h4 id="sec-10-2">Proxy Socks mediante ssh</h4>
<div class="outline-text-4" id="text-10-2">





<pre class="example">ssh -D 9090 osiux.com    
</pre>


</div>

</div>

<div id="outline-container-10-3" class="outline-4">
<h4 id="sec-10-3">Tunel reverso con ssh</h4>
<div class="outline-text-4" id="text-10-3">





<pre class="example">ssh -R 12345:localhost:22 osiux.com    
</pre>


</div>

</div>

<div id="outline-container-10-4" class="outline-4">
<h4 id="sec-10-4">Redireccionar puertos con <code>socat</code></h4>
<div class="outline-text-4" id="text-10-4">

</div>
</div>

</div>

<div id="outline-container-11" class="outline-3">
<h3 id="sec-11">Cómo saber la IP de un equipo?</h3>
<div class="outline-text-3" id="text-11">


</div>

<div id="outline-container-11-1" class="outline-4">
<h4 id="sec-11-1">B dice, <b>cuál es la IP de D?</b></h4>
<div class="outline-text-4" id="text-11-1">


<ul>
<li>Se que D es <b>00:14:d1:18:4a:dd</b>
</li>
<li>Yo soy B y mi mac es <b>00:14:d1:18:4a:bb</b>
</li>
<li>Todos reciben paquete ARP por difusión
</li>
</ul>





<pre class="src src-ditaa">&lt;----+&lt;--------+--------&gt;+--------&gt;+----&gt;
     |         ^         |         |
     v         |         v         v
   +-+-+     +-+-+     +-+-+     +-+-+
   | A |     | B |     | C |     | D |
   +---+     +---+     +---+     +---+
</pre>


<p>
    <img src="redes-arp-1.png"  alt="redes-arp-1.png" />
</p>
</div>

</div>

<div id="outline-container-11-2" class="outline-4">
<h4 id="sec-11-2">D contesta, <b>mi IP es 10.4.14.225</b></h4>
<div class="outline-text-4" id="text-11-2">





<pre class="src src-ditaa">-----+---------+&lt;--------+---------+-----
     |         |         |         ^
     |         v         |         |
   +-+-+     +-+-+     +-+-+     +-+-+
   | A |     | B |     | C |     | D |
   +---+     +---+     +---+     +---+
</pre>


<p>
    <img src="redes-arp-2.png"  alt="redes-arp-2.png" />
</p>
</div>

</div>

<div id="outline-container-11-3" class="outline-4">
<h4 id="sec-11-3">Quénes están en esta red?</h4>
<div class="outline-text-4" id="text-11-3">





<pre class="src src-sh">sudo arp-scan --interface eth0 --localnet
</pre>


<pre class="example">

0 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.8.1: 256 hosts scanned in 1.625 seconds (157.54 hosts/sec). 0 responded
</pre>


</div>

</div>

<div id="outline-container-11-4" class="outline-4">
<h4 id="sec-11-4">pingueando</h4>
<div class="outline-text-4" id="text-11-4">





<pre class="src src-sh">ping -c 5 127.0.0.1
</pre>



<pre class="example">PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
64 bytes from 127.0.0.1: icmp_req=1 ttl=64 time=0.058 ms
64 bytes from 127.0.0.1: icmp_req=2 ttl=64 time=0.061 ms
64 bytes from 127.0.0.1: icmp_req=3 ttl=64 time=0.060 ms
64 bytes from 127.0.0.1: icmp_req=4 ttl=64 time=0.058 ms
64 bytes from 127.0.0.1: icmp_req=5 ttl=64 time=0.061 ms

--- 127.0.0.1 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 3999ms
rtt min/avg/max/mdev = 0.058/0.059/0.061/0.008 ms
</pre>


</div>

</div>

<div id="outline-container-11-5" class="outline-4">
<h4 id="sec-11-5">capturando pings</h4>
<div class="outline-text-4" id="text-11-5">





<pre class="src src-sh">sudo tcpdump -i lo -nnnt -c 5 icmp
</pre>



</div>

</div>

<div id="outline-container-11-6" class="outline-4">
<h4 id="sec-11-6">viendo un <code>ping</code></h4>
<div class="outline-text-4" id="text-11-6">





<pre class="example">sudo tcpdump -i lo -nnntvvX -c 1 -e icmp
</pre>



<pre class="example">00:00:00:00:00:00 &gt; 00:00:00:00:00:00, ethertype IPv4 (0x0800), length 98: (tos 0x0, ttl 64, id 0, offset 0, flags [DF], proto ICMP (1), length 84)
    127.0.0.1 &gt; 127.0.0.1: ICMP echo request, id 4177, seq 329, length 64
  0x0000:  4500 0054 0000 4000 4001 3ca7 7f00 0001  E..T..@.@.&lt;.....
  0x0010:  7f00 0001 0800 a68d 1051 0149 e754 5e51  .........Q.I.T^Q
  0x0020:  022f 0d00 0809 0a0b 0c0d 0e0f 1011 1213  ./..............
  0x0030:  1415 1617 1819 1a1b 1c1d 1e1f 2021 2223  .............!"#
  0x0040:  2425 2627 2829 2a2b 2c2d 2e2f 3031 3233  $%&amp;'()*+,-./0123
  0x0050:  3435 3637                                4567     
</pre>


</div>
</div>

</div>

<div id="outline-container-12" class="outline-3">
<h3 id="sec-12">Red con acceso a otra red</h3>
<div class="outline-text-3" id="text-12">





<pre class="src src-ditaa">-----+---------+&lt;--------+---------+-----
     |         |         |         ^
     |         v         |         |
   +-+-+     +-+-+     +-+-+     +-+-+
   | A |     | B |     | C |     | D |
   +---+     +---+     +---+     +-+-+
                                   |
                                   |
                                   +-----
</pre>


<p>
   <img src="redes-lan-wan.png"  alt="redes-lan-wan.png" />
</p>



<pre class="src src-ditaa">-----+---------+--------&gt;+--------&gt;+-----
     |         ^         |         |
     |         |         |         v
   +-+-+     +-+-+     +-+-+     +-+-+
   | A |     | B |     | C |     | D |
   +---+     +---+     +---+     +-+-+
                                   |
                                   v
                                 +-+-+
                                 | E |
                                 +-+-+
                                   |
                                   v
</pre>


<p>
   <img src="redes-lan-proxy-wan.png"  alt="redes-lan-proxy-wan.png" />
</p>
</div>

</div>

<div id="outline-container-13" class="outline-3">
<h3 id="sec-13">protocolos</h3>
<div class="outline-text-3" id="text-13">





<pre class="src src-ditaa">+----------+
| TCP/UDP  |
+----------+
| IP/ICMP  |
+----------+
| ARP      |
+----------+
| ETHERNET |
+----------+
</pre>


<p>
   <img src="redes-protocolos.png"  alt="redes-protocolos.png" />
</p>

</div>

<div id="outline-container-13-1" class="outline-4">
<h4 id="sec-13-1">Qué tiene un paquete TCP/IP?</h4>
<div class="outline-text-4" id="text-13-1">





<pre class="src src-ditaa">+------------------------+--------------------------+
| MAC origen fe:ca:fe:ca | MAC destino  ca:fe:ca:fe |
+------------------------+--------------------------+
| IP origen 192.168.1.22 | IP destino  96.8.118.129 |
+---------------------------------------------------+
| Puerto origen    45678 | Puerto destino: 80       |
+------------------------+--------------------------+
| Nro Secuencia    12345 | Nro ACK                  |
+---+---+---+---+---+----+--------------------------+
| U | A | P | R | S | F | GET / HTTP/1.0            |
| R | C | S | S | Y | I |                           |
| G | K | H | T | N | N |                           |
+---+---+---+---+---+---+---------------------------+    
</pre>


<p>
    <img src="redes-arp-header.png"  alt="redes-arp-header.png" />
</p>
</div>

</div>

<div id="outline-container-13-2" class="outline-4">
<h4 id="sec-13-2">Ethernet header</h4>
<div class="outline-text-4" id="text-13-2">





<pre class="src src-ditaa">+-------------------+-------------------+-------------------+---+
|                   |1                  |2                  |3  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|1|2|3|4|5|6|7|8|9|0|1|2|3|4|5|6|7|8|9|0|1|2|3|4|5|6|7|8|9|0|1|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Hardware type         |          Protocol type        |
+---------------+---------------+-------------------------------+
|Hw address len.|Pr address len.|             Opcode            |
+-------------------------------+-------------------------------+
|               Source hardware address                         |
+---------------------------------------------------------------+
|               Source protocol address                         |
+---------------------------------------------------------------+
|               Destination hardware address                    |
+---------------------------------------------------------------+
|               Destination protocol address                    |
+---------------------------------------------------------------+
|                            Data                               |
+---------------------------------------------------------------+
</pre>


<p>
    <img src="redes-arp-header.png"  alt="redes-arp-header.png" />
</p>
</div>
</div>

</div>

<div id="outline-container-14" class="outline-3">
<h3 id="sec-14">IP header</h3>
<div class="outline-text-3" id="text-14">





<pre class="src src-ditaa">+-------------------+-------------------+-------------------+---+
|                   |1                  |2                  |3  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|1|2|3|4|5|6|7|8|9|0|1|2|3|4|5|6|7|8|9|0|1|2|3|4|5|6|7|8|9|0|1|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version|  IHL  | Diff.Services |     Total length              |
+-------+-------+---------------+-----+-------------------------+
|        Identification         |Flags|         Fragment offset |
+---------------+---------------+-----+-------------------------+
|    TTL        | Protocol      | Header checksum               |
+---------------+---------------+-------------------------------+
|                       Source IP address                       |
+---------------------------------------------------------------+
|                  Destination IP address                       |
+---------------------------------------------------------------+
|                     Options and padding                       |
+---------------------------------------------------------------+
</pre>


<p>
   <img src="redes-ip-header.png"  alt="redes-ip-header.png" />
</p>
</div>

</div>

<div id="outline-container-15" class="outline-3">
<h3 id="sec-15">TCP header</h3>
<div class="outline-text-3" id="text-15">





<pre class="src src-ditaa">+-------------------+-------------------+-------------------+---+
|                   |1                  |2                  |3  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|1|2|3|4|5|6|7|8|9|0|1|2|3|4|5|6|7|8|9|0|1|2|3|4|5|6|7|8|9|0|1|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Source Port          |        Destination Port       |
+-------------------------------+-------------------------------+
|                        Sequence Number                        |
+-------------------------------+-------------------------------+
|                     Acknowledgment Number                     |
+-------+-----+-----+-+-+-+-+-+-+-------------------------------+
|dOffset|rsrvd| ECN |U|A|P|R|S|F|        Window                 |
|       |     |     |R|C|S|S|Y|I|                               |
|       |     |     |G|K|H|T|N|N|                               |
+-------+-----+-----+-+-+-+-+-+-+-------------------------------+
| Checksum                      | Urgent Pointer                |
+-------------------------------+-------------------------------+
|                      Options and padding                      |
+---------------------------------------------------------------+
|                           Data                                |
+---------------------------------------------------------------+
</pre>


<p>
   <img src="redes-tcp-header.png"  alt="redes-tcp-header.png" />
</p>
</div>

</div>

<div id="outline-container-16" class="outline-3">
<h3 id="sec-16">ChangeLog</h3>
<div class="outline-text-3" id="text-16">


<ul>
<li><span class="timestamp-wrapper"> <span class="timestamp">2013-04-04 jue</span></span> primer borrador general.
</li>
<li><span class="timestamp-wrapper"> <span class="timestamp">2013-04-09 mar</span></span> corrijo gráficos ascii-art
</li>
</ul>


<p>
[fn:arp] <a href="http://www.networksorcery.com/enp/protocol/arp.htm">http://www.networksorcery.com/enp/protocol/arp.htm</a>
</p>
</div>
</div>
</div>

<div id="postamble">
<p class="date">Fecha: 2013-04-04</p>
<p class="author">Autor: Osiris Alejandro Gómez</p>
<p class="creator"><a href="http://orgmode.org">Org</a> version 7.9.2 with <a href="http://www.gnu.org/software/emacs/">Emacs</a> version 23</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
